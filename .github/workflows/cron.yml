name: Diurna Cron Jobs

on:
  schedule:
    - cron: '*/15 * * * *'   # fetch-feeds every 15 min
    - cron: '*/10 * * * *'   # autopilot every 10 min
  workflow_dispatch:           # manual trigger

jobs:
  fetch-feeds:
    runs-on: ubuntu-latest
    if: github.event.schedule == '*/15 * * * *' || github.event_name == 'workflow_dispatch'
    steps:
      - name: Trigger fetch-feeds
        run: |
          curl -s -X GET "https://todayfootballmatch.com/api/cron/fetch-feeds" \
            -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
            -H "x-vercel-cron: 1"

  autopilot:
    runs-on: ubuntu-latest
    if: github.event.schedule == '*/10 * * * *' || github.event_name == 'workflow_dispatch'
    steps:
      - name: Trigger autopilot
        run: |
          curl -s -X GET "https://todayfootballmatch.com/api/cron/autopilot" \
            -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
            -H "x-vercel-cron: 1"
